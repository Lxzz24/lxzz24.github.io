## 2.1 指令系统

### 2.1.1 CISC 和 RISC

![5](https://gxmnzl.cn///img/RKm0105.png)

- **CISC**
   - **Complex** Instuction Set Computer，复杂指令集计算机
   - 目前使用的绝大多数计算机都属于 CISC
- **RISC**
   - **Reduced** Instuction Set Computer，精简指令集计算机

### 2.1.2 流水线

指令流水线：输入 **$I_{0.1s}$** → 计算 **$C_{0.2s}$** → 输出 **$O_{0.3s}$**

|            |           |           |           |           |           |           |               |               |
| :--------: | :-------: | :-------: | :-------: | :-------: | :-------: | :-------: | :-----------: | :-----------: |
|            | **$T_1$** | **$T_2$** | **$T_3$** | **$T_4$** | **$···$** | **$T_n$** | **$T_{n+1}$** | **$T_{n+2}$** |
|  **$I$**   |   $I_1$   |   $I_2$   |   $I_3$   |   $I_4$   |   $···$   |   $I_n$   |               |               |
|  **$C$**   |           |   $C_1$   |   $C_2$   |   $C_3$   |   $···$   | $C_{n-1}$ |     $C_n$     |               |
|  **$O$**   |           |           |   $O_1$   |   $O_2$   |   $···$   | $O_{n-2}$ |   $O_{n-1}$   |     $O_n$     |
|  **效率**  |    1/3    |    2/3    |   100%    |   100%    |   $···$   |   100%    |      2/3      |      1/3      |
| **$Time$** |   0.1s    |   0.2s    |   0.3s    |   0.3s    |   $···$   |   0.3s    |     0.3s      |     0.3s      |


- $T_{总用时} = T_{第一条指令的执行时间}+(n-1)\times T_{最长执行时间}$

- $\frac{不采用流水线}{采用流水线} = 加速比$

- 操作周期：$T_{最长执行时间}$

- **吞吐率**：$\frac{1s}{T_{最长执行时间}}$

- 执行 n 条指令的吞吐率：$\frac{n}{T_{总用时}}$


## 2.2 存储器

![6](https://gxmnzl.cn///img/RKm0106.png)

### 2.2.1 按所处的位置分类：
  - 内存（主存）：DRAM动态随机存储器（相对的：SRAM静态随机存储器）
    - 周期性地刷新
  - 外存（辅存）

?> $虚拟存储器 = 主存 + 辅存$

### 2.2.2 按工作方式分类
- 读 / 写存储器（RAM）
  - 能够读取 / 存入数据
- 只读存储器
  - 固定只读存储器ROM
  - 可编程的只读存储器PROM
  - 可擦除可编程的只读存储器EPROM
  - 电擦除可编程的只读存储器EEPROM
  - 闪速存储器（**闪存**）
    - 以块为单位删除
    - U盘
    - 信息不会丢失
    - 代替ROM
    - 不能代替主存

### 2.2.3 按访问方式分类
  - 按地址访问的存储器
  - 按**内容访问**的存储器 —— **相联存储器**

### 2.2.4 按寻址方式分类
  - 随机存储器
  - 顺序存储器
  - 直接存储器

> 空间局部性  
> 时间局部性  


### 2.2.1 Cache

1. 高速缓存用来**存放当前最活跃的程序和数据**。

特点：

- 位于 CPU 与主存之间
- 容量一般在几千字节到几兆字节之间
- 速度一般比主存快 5~10 倍，由快速半导体存储器构成
- 其内容对程序员来说是透明的

![7](https://gxmnzl.cn///img/RKm0107.png)

**提高 CPU 访问主存指令的效率**

#### 2.2.1.1 替换算法

- 目标：使 Cache 获得尽可能高的命中率
   - 随机替换算法
   - 先进先出算法
   - 近期最少使用算法
   - 优化替换算法

![8](https://gxmnzl.cn///img/RKm0108.png)

Cache 容量越大，则命中率越高，随着 Cache 容量的增加，其失效率接近 0%

#### 2.2.1.2 地址映像方法
在 CPU 工作时，送出的是主存单元的地址，而应从 Cache 存储器中读 / 写信息。需要将主存地址转换成 Cache 存储器的地址，即地址映像。

##### (1) **直接映像**

主存的块与 Cache 块的对应关系是固定的

- 优点：地址变换很简单
- 缺点：灵活性差
   - 不同区号中块号相同的块无法同时调入 Cache 存储器

![9](https://gxmnzl.cn///img/RKm0109.png)

##### (2) **全相联映像**

允许主存的任一块可以调入 Cache 存储器的任何一个块的空间中

- 优点：主存的块调入 Cache 的位置不受限制，十分灵活
- 缺点：无法从主存块号中直接获得 Cache 的块号，变换比较复杂，速度比较慢

![10](https://gxmnzl.cn///img/RKm0110.png)


##### (3) **组相联映像**

![11](https://gxmnzl.cn///img/RKm0111.png)

组相联的地址构成为：区号+组号+块号+块内地址。


!> Cache 与主存地址的映射是由硬件自动完成的

### 2.2.2 中断

![12](https://gxmnzl.cn///img/RKm0112.png)

计算机在执行程序过程中，当遇到急需处理的事件时，暂停当前正在运行的程序，转去执行有关服务程序，处理完后自动返回源程序的过程。

- **中断向量**（断点）：提供中断服务程序的入口地址
   - 为提高响应中断的速度 → 汇集为中断向量表
- **中断响应时间**：发出中断请求 → 进入中断服务程序
- **保存现场**：存档，返回来继续执行源程序


## 2.3 输入输出（I/O）控制方式

### 2.3.1 程序查询方式（直接程序控制方式）

1. **CPU 和 I/O（外设）只能串行工作**，CPU 需要一直轮询检查，长期处于忙等状态。CPU 利用率低
2. 一次只能读 / 写一个字（byte）
3. 由 CPU 将数放入内存

![13](https://gxmnzl.cn///img/RKm0113.png)

### 2.3.2 中断（驱动）方式

1. I/O 设备通过中断信号主动向 CPU 报告 I/O 操作已完成
2. **CPU 和 I/O（外设）可并行工作**
3. CPU 利用率得到提升
4. 一次只能读 / 写一个字（byte）
5. 由 CPU 将数放入内存

![14](https://gxmnzl.cn///img/RKm0114.png)

### 2.3.3 直接存储器（DMA）方式

1. **CPU 和 I/O （外设）可并行工作**
2. **仅在传送数据块的开始和结束时才需要 CPU 的干预**
3. **由外设直接将数据放入内存**
4. 一次读写的单位为“块”而不是字

![15](https://gxmnzl.cn///img/RKm0115.png)

## 2.4 总线

?> 只有 1 分，知识点很多很偏

分类：  
  数据总线、地址总线、控制总线

常见：
  1. ISA 总线
  2. EISA 总线
  3. **PCI 总线**
     - **微型机**上广泛采用的**内总线**，采用**并行传输**方式
  4. PCI Express 总线
  5. 前端总线
  6. RS-232C
  7. **SCSI**
     - **并行外总线**
  8. SATA
  9. USB
  10. IEEE-1394
  11. IEEE-488
